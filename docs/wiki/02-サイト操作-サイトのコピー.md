# サイトのコピー - items/{siteId}/copysitepackage

## 概要

指定したサイトをコピーします。フォルダ構造を含むサイトパッケージ全体をコピーすることができます。

## 対応バージョン

- プリザンター 1.3.13.0以降
  - このライブラリの制約によるもの

## 制限事項

- テナント管理者権限が必要です
- 期限付きテーブルおよび記録テーブルのみ使用可能です

## メソッド

```csharp
Task<ApiResponse<CopySitePackageResponse>> CopySitePackageAsync(
    long siteId,
    List<SelectedSite> selectedSites,
    long? targetSiteId = null,
    string? siteTitle = null,
    bool? includeSitePermission = null,
    bool? includeRecordPermission = null,
    bool? includeColumnPermission = null,
    bool? includeNotifications = null,
    bool? includeReminders = null,
    TimeSpan? timeout = null)

Task<ApiResponse<CopySitePackageResponse>> CopySitePackageAsync(long siteId, CopySitePackageRequest request, TimeSpan? timeout = null)
```

## パラメータ

| 引数 | 型 | 必須 | 説明 |
|------|------|:----:|------|
| `siteId` | long | ✓ | コピーするサイトのうちタイトル更新対象のサイトID |
| `selectedSites` | List\<SelectedSite\> | ✓ | コピーするサイトの一覧 |
| `targetSiteId` | long? | | コピー先のフォルダのサイトID。省略する場合、トップ画面にコピーします。 |
| `siteTitle` | string? | | サイトのタイトル。サイトのタイトルを変更する場合に使用してください。 |
| `includeSitePermission` | bool? | | サイトのアクセス権を含めるかどうか |
| `includeRecordPermission` | bool? | | レコードのアクセス権を含めるかどうか |
| `includeColumnPermission` | bool? | | 項目のアクセス権を含めるかどうか |
| `includeNotifications` | bool? | | 通知設定を含めるかどうか |
| `includeReminders` | bool? | | リマインダー設定を含めるかどうか |
| `timeout` | TimeSpan? | | リクエストタイムアウト |

## SelectedSite クラス

| プロパティ | 型 | 説明 |
|------|------|------|
| `SiteId` | long | コピー対象のサイトID |
| `IncludeData` | bool? | データを含めるかどうか（省略時：true） |

## 使用例

### 単一サイトをコピー

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Sites;

// コピー対象のサイトを指定
var selectedSites = new List<SelectedSite>
{
    new SelectedSite { SiteId = 123 }
};

// サイトをコピー
var result = await client.CopySitePackageAsync(
    siteId: 123,
    selectedSites: selectedSites);

if (result.IsSuccess)
{
    var copiedSites = result.Response?.GetCopiedSites();
    if (copiedSites != null)
    {
        foreach (var site in copiedSites)
        {
            Console.WriteLine($"旧サイトID: {site.OldSiteId} → 新サイトID: {site.NewSiteId}");
            Console.WriteLine($"タイプ: {site.ReferenceType}, タイトル: {site.Title}");
        }
    }
}
```

### タイトルを変更してコピー

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Sites;

var selectedSites = new List<SelectedSite>
{
    new SelectedSite { SiteId = 123 }
};

// タイトルを変更してコピー
var result = await client.CopySitePackageAsync(
    siteId: 123,
    selectedSites: selectedSites,
    siteTitle: "新しいタイトル");
```

### 特定フォルダにコピー

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Sites;

var selectedSites = new List<SelectedSite>
{
    new SelectedSite { SiteId = 123 }
};

// 指定したフォルダにコピー
var result = await client.CopySitePackageAsync(
    siteId: 123,
    selectedSites: selectedSites,
    targetSiteId: 456);  // コピー先フォルダのサイトID
```

### 複数サイトをデータなしでコピー

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Sites;

var selectedSites = new List<SelectedSite>
{
    new SelectedSite { SiteId = 123 },
    new SelectedSite 
    { 
        SiteId = 124, 
        IncludeData = false  // データを含めない
    }
};

var result = await client.CopySitePackageAsync(
    siteId: 123,
    selectedSites: selectedSites,
    targetSiteId: 456,
    siteTitle: "テスト環境用");
```

### 権限と通知設定を含めてコピー

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Sites;

var selectedSites = new List<SelectedSite>
{
    new SelectedSite { SiteId = 123 }
};

// 各種設定を含めてコピー
var result = await client.CopySitePackageAsync(
    siteId: 123,
    selectedSites: selectedSites,
    targetSiteId: 456,
    includeSitePermission: false,
    includeRecordPermission: true,
    includeColumnPermission: false,
    includeNotifications: true,
    includeReminders: true);
```

### リクエストオブジェクト使用版

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Sites;

var request = new CopySitePackageRequest
{
    TargetSiteId = 456,
    SiteTitle = "新規プロジェクト",
    SelectedSites = new List<SelectedSite>
    {
        new SelectedSite { SiteId = 123 },
        new SelectedSite { SiteId = 124, IncludeData = false }
    },
    IncludeSitePermission = false,
    IncludeRecordPermission = true,
    IncludeColumnPermission = false,
    IncludeNotifications = true,
    IncludeReminders = true
};

var result = await client.CopySitePackageAsync(siteId: 123, request);
```

## レスポンス

### CopySitePackageResponse

| プロパティ | 型 | 説明 |
|------|------|------|
| `Data` | string? | コピーされたサイトのデータ（JSON文字列） |

### メソッド

| メソッド | 戻り値 | 説明 |
|------|------|------|
| `GetCopiedSites()` | List\<CopiedSiteData\>? | コピーされたサイトの情報リストを取得 |

### CopiedSiteData

| プロパティ | 型 | 説明 |
|------|------|------|
| `OldSiteId` | long | コピー元のサイトID |
| `NewSiteId` | long | コピー先の新しいサイトID |
| `ReferenceType` | string? | 参照タイプ（Sites, Results, Issuesなど） |
| `Title` | string? | サイトのタイトル |
