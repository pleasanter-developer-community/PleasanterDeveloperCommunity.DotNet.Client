# 検索インデックスの再構築 - backgroundtasks/rebuildsearchindexes

## 概要

APIを使用して検索インデックスを再構築します。全サイトまたは特定のサイトを対象に再構築を実行できます。

## 対応バージョン

- プリザンター 1.3.13.0以降
  - このライブラリの制約によるもの

## 必要な設定

この機能を利用するには、プリザンターのパラメータ設定で `BackgroundTask.Enabled` を有効にする必要があります。

## メソッド

```csharp
// 全サイト対象版
Task<ApiResponse<RebuildSearchIndexesResponse>> RebuildAllSearchIndexesAsync(
    TimeSpan? timeout = null)

// 全サイト対象版（リクエストモデル）
Task<ApiResponse<RebuildSearchIndexesResponse>> RebuildAllSearchIndexesAsync(
    RebuildSearchIndexesRequest request,
    TimeSpan? timeout = null)

// 特定サイト対象版
Task<ApiResponse<RebuildSearchIndexesResponse>> RebuildSearchIndexesAsync(
    long siteId,
    TimeSpan? timeout = null)

// 特定サイト対象版（リクエストモデル）
Task<ApiResponse<RebuildSearchIndexesResponse>> RebuildSearchIndexesAsync(
    long siteId,
    RebuildSearchIndexesRequest request,
    TimeSpan? timeout = null)
```

## パラメータ

### 全サイト対象版 (`RebuildAllSearchIndexesAsync`)

| 引数      | 型        | 必須 | 説明                   |
|-----------|-----------|:----:|------------------------|
| `timeout` | TimeSpan? |      | リクエストタイムアウト |

### 特定サイト対象版 (`RebuildSearchIndexesAsync`)

| 引数      | 型        | 必須 | 説明                   |
|-----------|-----------|:----:|------------------------|
| `siteId`  | long      | Yes  | サイトID               |
| `timeout` | TimeSpan? |      | リクエストタイムアウト |

## 使用例

### 全サイトの検索インデックスを再構築

```csharp
var result = await client.RebuildAllSearchIndexesAsync();

if (result.IsSuccess)
{
    Console.WriteLine($"メッセージ: {result.Message}");
}
```

### 特定サイトの検索インデックスを再構築

```csharp
var result = await client.RebuildSearchIndexesAsync(siteId: 123);

if (result.IsSuccess)
{
    Console.WriteLine($"メッセージ: {result.Message}");
}
```

### リクエストモデルを使用

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.BackgroundTasks;

var request = new RebuildSearchIndexesRequest();

var result = await client.RebuildAllSearchIndexesAsync(request);

if (result.IsSuccess)
{
    Console.WriteLine($"メッセージ: {result.Message}");
}
```

## レスポンス

### 成功時

```json
{
  "Id": 0,
  "StatusCode": 200,
  "Message": "検索インデックスの再構築をバックグラウンドで開始しました。"
}
```

### エラー時

```json
{
  "Id": 0,
  "StatusCode": 500,
  "Message": "バックグラウンドタスクが無効です。"
}
```

## レスポンスの処理

```csharp
var result = await client.RebuildAllSearchIndexesAsync();

if (result.IsSuccess)
{
    // 成功時の処理
    Console.WriteLine($"メッセージ: {result.Message}");
}
else
{
    // エラー時の処理
    Console.WriteLine($"エラー: {result.StatusCode} - {result.Message}");
}
```

## 注意事項

- この機能には `BackgroundTask.Enabled` パラメータの有効化が必要です
- 検索インデックスの再構築はバックグラウンドで実行されます
- 大量のデータがある場合、再構築には時間がかかる場合があります

## 関連項目

- [プリザンター公式マニュアル](https://pleasanter.org/ja/manual)
