# テーブルのエクスポート - items/{siteId}/export

## 概要

指定したサイトIDのテーブルをエクスポートします。CSVまたはJSON形式でデータを出力できます。

## 対応バージョン

- プリザンター 1.3.13.0以降
  - このライブラリの制約によるもの

## メソッド

```csharp
// パラメータ指定版
Task<ApiResponse<ExportResponse>> ExportAsync(long siteId, int? exportId = null, ExportSetting? export = null, View? view = null, TimeSpan? timeout = null)

// リクエストモデル版
Task<ApiResponse<ExportResponse>> ExportAsync(long siteId, ExportRequest request, TimeSpan? timeout = null)
```

## パラメータ

| 引数 | 型 | 必須 | 説明 |
|------|------|:----:|------|
| `siteId` | long | Yes | サイトID |
| `exportId` | int? | | エクスポート設定ID（プリザンターで作成済みのエクスポート設定を使用する場合） |
| `export` | ExportSetting | | エクスポート設定（設定を直接記述する場合） |
| `view` | View | | ビュー設定（取得するレコードの絞り込みや並び順を指定） |
| `timeout` | TimeSpan? | | リクエストタイムアウト |

## 使用例

### 標準のエクスポート設定でエクスポート

```csharp
// 標準のエクスポート設定でエクスポート
var result = await client.ExportAsync(siteId: 123);

if (result.IsSuccess)
{
    Console.WriteLine($"ファイル名: {result.Response?.Name}");
    Console.WriteLine($"内容: {result.Response?.Content}");
}
```

### プリザンターで作成済みのエクスポート設定を使用

```csharp
// プリザンターで作成済みのエクスポート設定ID=1を使用
var result = await client.ExportAsync(siteId: 123, exportId: 1);
```

### エクスポート設定を直接指定

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Items;
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Types;

// エクスポート設定を直接指定
var exportSetting = new ExportSetting
{
    Name = "カスタムエクスポート",
    Columns = new List<ExportColumn>
    {
        new ExportColumn { ColumnName = "Title" },
        new ExportColumn { ColumnName = "Body" },
        new ExportColumn { ColumnName = "ClassA" }
    },
    Header = true,
    Type = ExportType.Csv  // Csv または Json
};

var result = await client.ExportAsync(siteId: 123, export: exportSetting);
```

### ビュー設定でフィルタ・ソートを指定

```csharp
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests;
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Items;
using PleasanterDeveloperCommunity.DotNet.Client.Models.Requests.Types;

// ビュー設定を使用してフィルタ・ソートを指定
var view = new View
{
    ColumnFilterHash = new Dictionary<string, string>
    {
        { "Owner", "[1]" }
    },
    ColumnSorterHash = new Dictionary<string, SortOrderType>
    {
        { "Title", SortOrderType.Desc }
    }
};

var result = await client.ExportAsync(siteId: 123, exportId: 1, view: view);
```

### ファイルとして保存

```csharp
var result = await client.ExportAsync(siteId: 123);

if (result.IsSuccess && result.Response != null)
{
    // ファイルとして保存
    File.WriteAllText(result.Response.Name ?? "export.csv", result.Response.Content);
}
```

## ExportSettingクラスのプロパティ

| プロパティ | 型 | 説明 |
|-----------|------|------|
| `Name` | string | エクスポート設定の名前 |
| `Columns` | List\<ExportColumn\> | 出力対象となる項目のリスト |
| `Header` | bool? | 出力するCSVにヘッダ行を追加するか否か |
| `Type` | ExportType? | 出力するファイルの種類（Csv または Json） |

## ExportType列挙体

| 値 | 説明 |
|------|------|
| `Csv` | CSV形式 |
| `Json` | JSON形式 |

## ExportColumnクラスのプロパティ

| プロパティ | 型 | 説明 |
|-----------|------|------|
| `ColumnName` | string | 列名 |

## ExportResponseクラスのプロパティ

| プロパティ | 型 | 説明 |
|-----------|------|------|
| `Name` | string | エクスポートファイル名 |
| `Content` | string | エクスポートデータ内容（CSVまたはJSON形式の文字列） |
